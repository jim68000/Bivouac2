TODO stackable middleware
TODO make everything except req, res and response an options object